<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ì„±ê³µ ë° í…ŒìŠ¤íŠ¸</title>
</head>
<body>
    <h2>ë¡œê·¸ì¸ ì„±ê³µ! (JWT ì¸ì¦ í…ŒìŠ¤íŠ¸)</h2>
    <p>JWT í† í°ì´ localStorageì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
    
    <h3>ìºë¦­í„° ìƒì„± í…ŒìŠ¤íŠ¸</h3>
    <input type="text" id="charName" placeholder="ìºë¦­í„° ì´ë¦„">
    <input type="text" id="charJob" placeholder="ì§ì—… (ì˜ˆ: warrior)">
    <button onclick="createCharacter()">ìºë¦­í„° ìƒì„±</button>
    
    <p id="result"></p>

    <script>
        const token = localStorage.getItem('jwtToken');
        if (!token) {
            alert('í† í°ì´ ì—†ìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.');
            window.location.href = 'login.html';
        }

        async function createCharacter() {
            const name = document.getElementById('charName').value;
            const job = document.getElementById('charJob').value;
            const resultElement = document.getElementById('result');

            try {
                const response = await fetch('/api/characters', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        // ğŸš¨ ì €ì¥ëœ JWT í† í°ì„ Authorization í—¤ë”ì— ë‹´ì•„ ë³´ëƒ…ë‹ˆë‹¤. (Bearer í•„ìˆ˜)
                        'Authorization': `Bearer ${token}` 
                    },
                    body: JSON.stringify({ name, job })
                });

                if (response.ok) {
                    const data = await response.json();
                    resultElement.textContent = `ìºë¦­í„° ìƒì„± ì„±ê³µ! ì´ë¦„: ${data.name}, ID: ${data.id}`;
                    // ì¶”ê°€ë¡œ GET /api/characters í˜¸ì¶œí•˜ì—¬ ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                } else {
                    const errorText = await response.text();
                    resultElement.textContent = `ìºë¦­í„° ìƒì„± ì‹¤íŒ¨ (${response.status}): ${errorText}`;
                }
            } catch (error) {
                resultElement.textContent = 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            }
        }
    </script>
</body>
</html>